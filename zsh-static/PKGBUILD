# Edit on github: https://github.com/LizardByte/Sunshine/blob/master/packaging/linux/Arch/PKGBUILD
# Reference: https://wiki.archlinux.org/title/PKGBUILD

VERSION=${VERSION:-5.8}
arch=('any')
pkgname='zsh-static'
pkgdesc="zsh-static (installed in /userdata/system/zsh/*)"
pkgrel=1
pkgver=$VERSION
install=.install
echo ${pkgver}

package() {
    echo $PWD

    # --- binaries
    mkdir -p userdata/system/zsh
    curl https://github.com/romkatv/zsh-bin/releases/download/v6.1.1/zsh-5.8-linux-aarch64.tar.gz -L -o zsh.tar.gz
    tar xvf zsh.tar.gz -C userdata/system/zsh
    rm zsh.tar.gz

    # --- ohmyzsh
    # tar -cf - ./userdata | xz -9ze -T0 > ../ohmyzsh-master.tar.xz 
    tar xvf ../ohmyzsh-master.tar.xz

    # --- .zshrc
    cp ../.zshrc userdata/system

    # --- .BATOEXEC
    mkdir -p userdata/system/pacman/batoexec
    cp ../.BATOEXEC userdata/system/pacman/batoexec/$pkgname

    # --- 
    mv userdata $pkgdir
}
